language: python
python:
  - 2.7
cache:
  directories:
    - $HOME/.cache/pip
before_script:
  - sudo -- sh -c "echo '127.0.0.1  boxoffice.travis.dev' >> /etc/hosts"
  - sudo -- sh -c "echo '127.0.0.1  testing.travis.dev' >> /etc/hosts"
  - psql -c 'create database boxoffice_testing;' -U postgres
install:
  - pip install -U pip wheel
  - pip install -r test_requirements.txt
  - pip install -r requirements.txt
  - pip install https://github.com/hasgeek/coaster/archive/master.zip
  - npm install casperjs
script:
  - nosetests -v tests
  - nohup python runtestserver.py &
  - cd tests
  - python -m SimpleHTTPServer 8000 &
  - cd ..
  - sleep 30
  - casperjs test tests
addons:
  postgresql: "9.4"
services:
  - redis-server
notifications:
  email: false
  slack:
    - hasgeek:HDCoMDj3T4ICB59qFFVorCG8
    - friendsofhasgeek:3bLViYSzhfaThJovFYCVD3fX
